<?xml version="1.0"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>CÃ©dric Champeau's blog</title>
    <link>https://melix.github.io/blog/</link>
    <atom:link href="https://melix.github.io/blog//feed.xml" rel="self" type="application/rss+xml" />
    <description>JBake Bootstrap Template</description>
    <language>en-gb</language>
    <pubDate>Fri, 12 Jul 2019 09:05:10 +0200</pubDate>
    <lastBuildDate>Fri, 12 Jul 2019 09:05:10 +0200</lastBuildDate>

    <item>
      <title>Dependency Management at Gradle</title>
      <link>https://melix.github.io/blog/2019/07/dependency-management.html</link>
      <pubDate>Thu, 11 Jul 2019 00:00:00 +0200</pubDate>
      <guid isPermaLink="false">2019/07/dependency-management.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&lt;em&gt;Opinions are my own, not those of my employer&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I joined Gradle 4 years ago, and I spent the last 2 years almost exclusively working on &lt;em&gt;dependency management&lt;/em&gt;.
The more I work on this topic, the more I am frustrated by the state of our industry.
In this blog post I will mostly illustrate my points with Java, which I&amp;#8217;m mostly familiar with, but a lot of them stand true whatever the ecosystem (Javascript, Python, Go, &amp;#8230;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Soon, we should release Gradle 6 (fall 2019, no promise, as always, this is software).
This version will be the first one to turn the spotlights on &lt;em&gt;dependency management&lt;/em&gt;.
This will be for me the achievement of 2 hard years of work (not alone, of course) but this is &lt;em&gt;just&lt;/em&gt; the beginning.
Gradle probably has the most advanced dependency engine of the market (forgive me if I&amp;#8217;m wrong, let me know).
But what makes it so different is not that it has powerful features like dependency substitution, customizable resolution, dependency locking, alignment, etc&amp;#8230;
No, what makes it different it&amp;#8217;s that we put a lot of emphasis on &lt;em&gt;semantics&lt;/em&gt;: model software correctly so that you, as a developer, have less to handle.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Often, folks &quot;from the outside&quot; are considering us &lt;em&gt;arrogant&lt;/em&gt;, because we don&amp;#8217;t immediately support things that other engines do (eg. &quot;you don&amp;#8217;t want to implement optional dependencies, look, Maven has it for years you s***&quot;).
While I understand the frustration, it doesn&amp;#8217;t mean that we don&amp;#8217;t hear.
In fact, we hear you loud, but the time it takes to land is just the consequence of willing to implement the correct solution to a problem.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For example, what does an &lt;em&gt;optional dependency&lt;/em&gt; mean?
A few months ago, I read this from the Yarn documentation which got me scared, and, to be honest, a bit despaired too:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/blog/img/optional-deps-yarn.png&quot; alt=&quot;optional deps yarn&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This looks like total non-sense to me.
Because we needed the infrastructure, it took some time but we implemented what we think is a &lt;em&gt;better&lt;/em&gt; solution.
In a nutshell, optional dependencies are &lt;em&gt;not optional&lt;/em&gt;.
They are things that you need &lt;em&gt;if you use a particular feature of a library&lt;/em&gt;.
So it means that if you depend on something, and that this something has &lt;em&gt;optional features&lt;/em&gt;, you can say what features you need and Gradle would give you the correct dependencies for this.
We called that &lt;a href=&quot;https://docs.gradle.org/current/userguide/feature_variants.html&quot;&gt;feature variants&lt;/a&gt;. Granted, the name isn&amp;#8217;t cool, but it&amp;#8217;s a matter of time until we refactor the documentation to make it easier to discover.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Similarly, we implemented back in Gradle 3.4 the separation of API and implementation dependencies for the Java world.
In fact, that&amp;#8217;s one of the reasons the &lt;code&gt;compile&lt;/code&gt; configuration has been &quot;soft deprecated&quot; for years now, and that we&amp;#8217;re going to nag you starting from Gradle 6.
I still hear people claiming they don&amp;#8217;t need this and that it&amp;#8217;s hard to understand but I stand by the fact they &lt;em&gt;deperately&lt;/em&gt; need them.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Why is it important? Because if you are a library author, you know that there are things that are &quot;your internal sauce&quot;: things which are implementation details, not part of the public API, and that should never be exposed to consumers.
This is the very reason Java 9 shipped with the module system: strong encapsulation.
However, how does it work for dependencies? There are also dependencies which are &lt;em&gt;part of your API&lt;/em&gt; and others which are not.
Say you use Guave internally. None of the Guava classes are visible on your public API, and it would be an error to do so.
Then it means that Guava &lt;em&gt;is an implementation dependency of your library&lt;/em&gt;.
When you do this, you should be allowed to replace Guava with something else at any time, without breaking any of your consumers.
The horrible reality is that if you use the Maven &lt;code&gt;&amp;lt;compile&amp;gt;&lt;/code&gt; scope, those dependencies are going to &lt;em&gt;leak&lt;/em&gt; to the consumers, and they could accidentally start using Guava just because it&amp;#8217;s available on the classpath (yeah, IDEs love this, the class is available for completion you know!).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is a problem with Maven because the POM file is used for 2 distinct purposes:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;representing the point of view of the producer, where &lt;code&gt;&amp;lt;compile&amp;gt;&lt;/code&gt; means &quot;I need this on my compile classpath&quot;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;representing the point of view of the consumer, where &lt;code&gt;&amp;lt;compile&amp;gt;&lt;/code&gt; semantics are there broken: it means &quot;add this to your compile classpath&quot;, but it means you leak dependencies which should have been on the &lt;code&gt;&amp;lt;runtime&amp;gt;&lt;/code&gt; scope!&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;With the Gradle &lt;a href=&quot;https://docs.gradle.org/current/userguide/java_library_plugin.html&quot;&gt;Java Library plugin&lt;/a&gt;, those issues &lt;em&gt;go away&lt;/em&gt;: we model those correctly, and when we generate a POM file, it has dependency declarations which &lt;em&gt;make sense for the consumer&lt;/em&gt;.
I&amp;#8217;ve been battling to explain this in conferences for years, yet, lots of people don&amp;#8217;t get how harmful to the whole ecosystem that design decision from Maven was: it just prevents smooth dependency upgrades, and contributes to the &quot;classpath explosion&quot;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In other words, you, as a developer, should &lt;em&gt;always know what you directly use&lt;/em&gt; (your first level dependencies).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As another example, we&amp;#8217;ve been yelling for years how bad exclusions are, but we did a really bad job at explaining &lt;em&gt;why&lt;/em&gt;.
The problem is also that we didn&amp;#8217;t have all the tools we needed to workaround them, so we said &quot;yeah it&amp;#8217;s bad&quot; but didn&amp;#8217;t really say that you can still use them in some cases.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In a nutshell, an &lt;em&gt;exclusion&lt;/em&gt; is bad because the dependency resolution engine doesn&amp;#8217;t know &lt;em&gt;why&lt;/em&gt; you excluded a dependency:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;is it because the producer had bad metadata, that the dependency should have been &quot;optional&quot;, or just absent altogether?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;is it because you don&amp;#8217;t use a specific &lt;em&gt;code path&lt;/em&gt; of a dependency and you just want to slim down the size of your distribution?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;is it because &lt;em&gt;something breaks&lt;/em&gt; if you use this dependency?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;is it because it&amp;#8217;s yet another logger on the classpath and this is not the one you use?&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Well, again, for all those use cases, the solutions are &lt;em&gt;different&lt;/em&gt;.
The logging use case is an illustration of this: how many of you have faced this infamous problem of having multiple SLF4J bindings on the classpath?
How do you fix that with Maven? Exclude of course!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;But wouldn&amp;#8217;t it better if you could express that &quot;between all those logger bindings, this is the one I choose&quot;.
Wouldn&amp;#8217;t it better if, as a &lt;em&gt;producer&lt;/em&gt; of a logger binding, you could say &quot;I implement this logger API, and it doesn&amp;#8217;t make sense to have multiple logger bindings on the classpath at the same time&quot;.
Well, this is what Gradle offers you, as a producer and as a consumer.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Modeling software is important, because it makes the industry better &lt;em&gt;as a whole&lt;/em&gt;.
By explaining &lt;em&gt;why&lt;/em&gt; instead of &lt;em&gt;how&lt;/em&gt;, &lt;strong&gt;the dependency management engine can take better decisions&lt;/strong&gt;.
It can fail if things are incompatible, it can ask you to choose between different implementations.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Do you need another example? Look at all those &quot;Maven classifiers&quot;. How many times did you got multiple conflicting implementations of the same thing &lt;em&gt;just because they had different classifiers&lt;/em&gt; (looking at you, Guava!).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The reality is that a classifier is a workaround for a bad model, incapable of expressing that you have different &lt;em&gt;things&lt;/em&gt; published at the same coordinates.
Sometimes I read comments like &quot;Gradle is just Maven with a Groovy DSL&quot;.
This is wrong at so many levels: Gradle empathizes on &lt;em&gt;strong modelling&lt;/em&gt; of software.
We need to think in terms of components (&quot;this is a library&quot;, &quot;this is a Boot application&quot;, &quot;this is a Gradle plugin&quot;), not in terms of &lt;em&gt;conventions&lt;/em&gt;.
Models are orthogonal to conventions: conventions are just a tool to make modelling easier to implement, but what matters is the model.
The DSL also doesn&amp;#8217;t matter: Groovy, Kotlin, whatever. What makes Gradle powerful is that it &lt;em&gt;understands what you build&lt;/em&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is one of the reasons we came with &lt;a href=&quot;https://blog.gradle.org/gradle-metadata-1.0&quot;&gt;Gradle Module Metadata&lt;/a&gt;, which is going to be enabled by default in Gradle 6.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;We, at Gradle, think that we can save a lot of developer time by simply putting more sense in those things we publish.
It&amp;#8217;s a waste of time and energy that we all have to fix, constantly, those conflicts between libraries.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And can we talk about ethics?
It&amp;#8217;s beyond me we can tolerate, as developers/engineers, repeated approximations, errors, just &lt;em&gt;because Maven does it this way&lt;/em&gt;?
I don&amp;#8217;t really care that we&amp;#8217;re &lt;em&gt;not compatible with Maven&lt;/em&gt;, as long as we &lt;em&gt;solve the problem&lt;/em&gt; and that we move towards well designed, better solutions.
Sometimes we have to make tradeoffs, but we can&amp;#8217;t compromise on reproducibility, correctness and performance.
Of course, we do our best to provide Maven compatibility, and again, sometimes make it even better in some situations (the Java Library plugin).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;My goal is that we, as a whole, move towards a better software delivery world.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The good thing is that what we&amp;#8217;re not alone.
This, is the result of years of experience from the team with very large builds, from customers of small to very large organizations, and discussions with talented open-source developers (special thanks from me to &lt;a href=&quot;https://twitter.com/ankinson&quot;&gt;Andy Wilkinson&lt;/a&gt; from the Spring team).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I posted this earlier this month on Twitter, this is a &lt;em&gt;real&lt;/em&gt; dependency graph, from an organization I have the opportunity to work with:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;imageblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;img src=&quot;/blog/img/real-dependency-graph.png&quot; alt=&quot;real dependency graph&quot;&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is not uncommon, this is the reality we live in.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And when you have such a dependency graph, you desperately need more modelling.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There are lots of good things coming in Gradle 6, stay tuned. In the meantime, a lot of what I discussed here has been presented in a couple of webinars:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://gradle.com/blog/dependency-management-fundamentals/&quot;&gt;Dependency Management fundamentals with Gradle&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://gradle.com/blog/dependency-management-part-2-handling-conflicts/&quot;&gt;Handling Conflicts and Customizing Resolution&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Another webinar is planned after summer, around multi-repository development.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Hope you&amp;#8217;ll enjoy!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Goodbye, Groovy!</title>
      <link>https://melix.github.io/blog/2019/03/goodbye-groovy.html</link>
      <pubDate>Thu, 21 Mar 2019 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">2019/03/goodbye-groovy.html</guid>
      	<description>
	&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_i_m_stepping_down_from_the_apache_groovy_project&quot;&gt;I&amp;#8217;m stepping down from the Apache Groovy project&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Today is a very sad day. I&amp;#8217;ve decided to resign from the Apache Groovy PMC, as well as a committer.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The trigger was that I &lt;a href=&quot;https://github.com/apache/groovy/commit/56c219eca0c028c95713a3abd74f14fa40cb0e6c&quot;&gt;dared pushing a Gradle Kotlin DSL&lt;/a&gt; and this had to be reverted.
Lots of people in the Groovy community see Kotlin as a threat. I don&amp;#8217;t. I use both languages everyday, for different purposes.
I wrote most of the static compiler for Groovy, and I have no problem saying that I believe Kotlin is better as a static language: the experience is more consistent, and very pleasant.
But nothing in Kotlin reaches the simplicity that Groovy offers. Running a single line script, the awesome Spock framework for testing, &amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The fact I work for Gradle Inc was also mentioned as a reason why I did push this file.
To me, this is questioning my integrity, which is something I cannot accept.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In practice, since Gradle announced a couple of years back that they would start using Kotlin as a language for its DSL, I&amp;#8217;ve been in a very complicated position.
Privately, I always get pinged whenever I say something good about Kotlin. Like, you should not do this, this is not good for us, or, Gradle is not nice with Groovy, what are you doing.
People always make jokes about Kotlin when they talk to me. I was at Gr8Conf Europe a few days after the announcement and man, that wasn&amp;#8217;t a pleasant experience.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I am CÃ©dric. I am not Gradle Inc.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I am CÃ©dric. I am not Kotlin.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I am CÃ©dric. I am not Groovy.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Technologies live and die, I&amp;#8217;m not interested in being married with a technology, I&amp;#8217;m interested in working with something that excites me.
The reality is that I&amp;#8217;ve been more excited with Kotlin than Groovy lately, and the attacks, conscious or not, public or private, that I get everytime I mention this language are tiring.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now, when I&amp;#8217;m going to say something good about Groovy, I hope folks will believe me.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_special_thanks&quot;&gt;Special thanks&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I want to thank Guillaume Laforge for this adventure. Man, you gave me the opportunity to join the project, its awesome community. You gave me a job, I was lucky enough to be paid to work on open-source software, and that&amp;#8217;s all because of you. For that I owe you everything, thank you!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Second, thanks to Paul King. You are the one that the Groovy community should never loose. People have mentioned that I would be a great loss, but that&amp;#8217;s not true: the reality is that I contributed almost nothing recently, and you did all the hard work. You are also an amazing person always trying to get the best of us. I will miss it.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Then Jochen Theodorou: thanks to you for all the hard work you&amp;#8217;ve done with the compiler. I would not have been able to write the static compiler without your help and insights on the internals of Groovy.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I&amp;#8217;d also would like to personally thank folks that make the community vibrant: SÃ¸ren Berg Glasius, Graeme Rocher, Jeff Scott Brown, IvÃ¡n LÃ³pez, Ãlvaro SÃ¡nchez and all the others I miss, don&amp;#8217;t take it personally, this is not easy for me.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Last but not least, thank you to the Groovy community. You&amp;#8217;ve been awesome, and I wouldn&amp;#8217;t be where I am without you. I may have been a bit sharp saying that the Groovy community as a whole sees me as a Trojan horse, that&amp;#8217;s not true, but the truth is that I don&amp;#8217;t want to fight anymore. Do not assume that because I quit the community is toxic: it&amp;#8217;s not. There&amp;#8217;s just a lot of understandable fear for the future, in my opinion. My advice is, embrace the change, don&amp;#8217;t look back, and take inspiration.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I want to say good luck to the team, in particular to its newer members, like Daniel Sun, who are the future of this language: they have the energy, the skills to make it better.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Last but not least, I&amp;#8217;m still a &lt;a href=&quot;https://opencollective.com/friends-of-groovy&quot;&gt;friend of Apache Groovy&lt;/a&gt;, you should be too!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>A simple native HTTP server with GraalVM</title>
      <link>https://melix.github.io/blog/2019/03/simple-http-server-graal.html</link>
      <pubDate>Tue, 19 Mar 2019 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">2019/03/simple-http-server-graal.html</guid>
      	<description>
	&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_writing_a_simple_http_server_with_graalvm&quot;&gt;Writing a simple HTTP server with GraalVM&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In my daily work, I often need to start a simple HTTP server to serve local files.
For example, this week I&amp;#8217;m going to give a talk at &lt;a href=&quot;https://www.breizhcamp.org&quot;&gt;Breizcamp&lt;/a&gt;, and because my presentation uses a &lt;a href=&quot;https://revealjs.com&quot;&gt;Reveal.js slide deck&lt;/a&gt; and that it loads resources dynamically, I need a &quot;real&quot; web server to serve the files.
So far, I&amp;#8217;ve been quite happy using the Python simple http server.
Using it is as easy as running:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;python -m SimpleHTTPServer 8000&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;But knowing that the JDK has an embedded HTTP server, and that there&amp;#8217;s a lot of hype around Graal those days, I wanted to see if we could achieve the same thing, with a fast startup, with GraalVM.
The answer is &lt;strong&gt;yes&lt;/strong&gt;, but the road wasn&amp;#8217;t so easy, at least for Groovy.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_show_me_the_code&quot;&gt;Show me the code&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The code for this experiment can be found on &lt;a href=&quot;https://github.com/melix/graal-simple-httpserver&quot;&gt;GitHub&lt;/a&gt;.
We&amp;#8217;re going to use:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;https://gradle.org/&quot;&gt;Gradle&lt;/a&gt; to build&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;the &lt;a href=&quot;https://github.com/palantir/gradle-graal&quot;&gt;Gradle Graal plugin&lt;/a&gt; from Palantir&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And because I like the &lt;a href=&quot;http://www.groovy-lang.org/&quot;&gt;Groovy&lt;/a&gt;, and especially its static compiler, my first attempt was to use statically compiled Groovy to do this.
Well, it turned out to become a nightmare, so after an hour trying to make it work, I switched to Kotlin, and try to make it work there first.
Knowing that Kotlin is a statically compiled language from the ground up and that it doesn&amp;#8217;t have the whole dynamic history of Groovy, I did expect it to be simpler.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So, in the end, here&amp;#8217;s what the Kotlin server looks like:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;HttpServer.kt&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint ruby language-ruby&quot;&gt;&lt;code&gt;fun main(args: Array&amp;lt;String&amp;gt;) {
    val port = if (args.size &amp;gt; 0) args[0].toInt() else 8080
    val baseDir = if (args.size &amp;gt; 1) File(args[1]).canonicalFile else File(&quot;.&quot;).canonicalFile

    create(InetSocketAddress(port), 0).run {
        createContext(&quot;/&quot;) { exchange -&amp;gt;
            exchange.run {
                val file = File(baseDir, requestURI.path).canonicalFile
                if (!file.path.startsWith(baseDir.path)) {
                    sendResponse(403, &quot;403 (Forbidden)\n&quot;)
                } else if (file.isDirectory) {
                    val base = if (file == baseDir) &quot;&quot; else requestURI.path
                    sendResponse(200, &quot;&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;&quot; +
                            file.list()
                                .map { &quot;&amp;lt;ul&amp;gt;&amp;lt;a href=\&quot;$base/${it}\&quot;&amp;gt;${it}&amp;lt;/a&amp;gt;&amp;lt;/ul&amp;gt;&quot; }
                                .joinToString(&quot;\n&quot;) + &quot;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&quot;)

                } else if (!file.isFile) {
                    sendResponse(404, &quot;404 (Not Found)\n&quot;)
                } else {
                    sendResponse(200) {
                        FileInputStream(file).use {
                            it.copyTo(this)
                        }
                    }
                }
            }
        }
        executor = null
        println(&quot;Listening at http://localhost:$port/&quot;)
        start()
    }
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It&amp;#8217;s quite simple indeed, and making this work as a GraalVM native image is extremely easy too. This is the &lt;em&gt;whole build file&lt;/em&gt;, this is all you need:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;build.gradle.kts&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;plugins {
   kotlin(&quot;jvm&quot;) version &quot;1.3.21&quot;
   id(&quot;com.palantir.graal&quot;) version &quot;0.3.0-6-g0b828af&quot;
}

repositories {
   jcenter()
}

dependencies {
   implementation(kotlin(&quot;stdlib&quot;))
}

graal {
   graalVersion(&quot;1.0.0-rc14&quot;)
   mainClass(&quot;HttpServerKt&quot;)
   outputName(&quot;httpserv-kt&quot;)
   option(&quot;--enable-http&quot;)
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As you can see, we just apply the Kotlin plugin to build our code, then the GraalVM plugin and configure the basics of the GraalVM plugin (version, main class, &amp;#8230;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Building the image can be done by calling:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;./gradlew http-kotlin:nativeImage&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;As &lt;a href=&quot;https://scans.gradle.com/s/nzkvn2gwkguf6&quot;&gt;you can see&lt;/a&gt;, building the whole thing takes around 15s on my laptop.
That is to say, compiling the server &lt;strong&gt;and&lt;/strong&gt; generating the native image.
Then you can try to serve files running:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;http-kotlin/build/graal/httpserv-kt 9090 /path/to/files&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;You&amp;#8217;ll see that the server starts immediately: there&amp;#8217;s absolutely no wait time, it&amp;#8217;s there and ready to answer.
The whole process took me less than 30 minutes, the native image is only 11MB. Success!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_making_it_work_with_groovy&quot;&gt;Making it work with Groovy&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Now that I had a proof-of-concept with Kotlin, I went back to Groovy.
And, I can say, despite the fact I love this language, that it was a nightmare to make it work.
At some point, I even thought of abandoning, however, using perseverance, I managed to work around all problems I faced.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Before I explain the problems, let&amp;#8217;s took a look at the final Groovy server:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;title&quot;&gt;HttpServerGroovy.groovy&lt;/div&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;@CompileStatic
abstract class HttpServerGroovy {

    // VERY dirty trick to avoid the creation of a groovy.lang.Reference
    static File baseDir

    static void main(String[] args) {
        def port = args.length &amp;gt; 0 ? args[0].toInteger() : 8080
        baseDir = args.length &amp;gt; 1 ? new File(args[1]).canonicalFile : new File(&quot;.&quot;).canonicalFile

        def server = HttpServer.create(new InetSocketAddress(port), 0)
        server.createContext(&quot;/&quot;, new HttpHandler() {
            @Override
            void handle(HttpExchange exchange) throws IOException {
                def uri = exchange.requestURI
                def file = new File(baseDir, uri.path).canonicalFile
                if (!file.path.startsWith(baseDir.path)) {
                    sendResponse(exchange, 403, &quot;403 (Forbidden)\n&quot;)
                } else if (file.directory) {
                    String base = file == baseDir ? &apos;&apos;: uri.path
                    String listing = linkify(base, file.list()).join(&quot;\n&quot;)
                    sendResponse(exchange, 200, String.format(&quot;&amp;lt;html&amp;gt;&amp;lt;body&amp;gt;%s&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;&quot;, listing))

                } else if (!file.file) {
                    sendResponse(exchange, 404, &quot;404 (Not Found)\n&quot;)
                } else {
                    sendResponse(exchange, 200, new FileInputStream(file))
                }
            }
        })
        server.executor = null
        System.out.println(String.format(&quot;Listening at http://localhost:%s/&quot;, port))
        server.start()
    }

    private static List&amp;lt;String&amp;gt; linkify(String base, String[] files) {
        def out = new ArrayList&amp;lt;String&amp;gt;(files.length)
        for (int i = 0; i &amp;lt; files.length; i++) {
            String file = files[i]
            out &amp;lt;&amp;lt; String.format(&quot;&amp;lt;ul&amp;gt;&amp;lt;a href=\&quot;%s/%s\&quot;&amp;gt;%s&amp;lt;/a&amp;gt;&amp;lt;/ul&amp;gt;&quot;, base, file, file)
        }
        out
    }
    ...&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The first thing you will notice is that it&amp;#8217;s far from being idiomatic Groovy.
Of course I used &lt;code&gt;@CompileStatic&lt;/code&gt;, because the static nature of GraalVM would have made this an even greater challenge to make it work with dynamic Groovy.
However, I didn&amp;#8217;t expect that it would be &lt;em&gt;so hard&lt;/em&gt; to make it work.
The resulting file is both a consequence of limitations of GraalVM, and historical background of Groovy.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;sect2&quot;&gt;
&lt;h3 id=&quot;_where_are_my_closures&quot;&gt;Where are my closures?&lt;/h3&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The first code I wrote was using idiomatic Groovy, with closures. However, as soon as I started to build my native image, I noticed this obscure error:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;com.oracle.graal.pointsto.constraints.UnsupportedFeatureException: Invoke with MethodHandle argument could not be reduced to at most a single call: java.lang.invoke.MutableCallSite.&amp;lt;init&amp;gt;(MethodHandle)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It&amp;#8217;s funny to see this &lt;code&gt;MethodHandle&lt;/code&gt; error when you know that the code is &lt;em&gt;fully statically compiled&lt;/em&gt;, and that it doesn&amp;#8217;t contain a single method handle.
However, the Groovy runtime does, and this is where the fun began.
First of all, GraalVM tells you what method is problematic. This was &lt;code&gt;org.codehaus.groovy.vmplugin.v7.IndyInterface.invalidateSwitchPoints&lt;/code&gt;.
Things are getting a little clearer: for some reason, the Groovy runtime is initialized, and we load the dynamic &lt;code&gt;IndyInterface&lt;/code&gt;, that I won&amp;#8217;t ever need.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The &quot;some reason&quot; needs a bit of explanation. Despite the fact that we use statically compiled Groovy, we&amp;#8217;re still implementing &lt;em&gt;Groovy specific interfaces&lt;/em&gt;. For example, the &lt;code&gt;GroovyObject&lt;/code&gt; interface.
Similarly, we honor class initialization the same way as a dynamic class, meaning that when a statically compiled Groovy class is instantiated, even if it doesn&amp;#8217;t contain any dynamic reference, we will initialize its metaclass, and as a consequence try to initialize the Groovy runtime.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;However something was &lt;em&gt;wrong&lt;/em&gt;: looking at my code I could not figure out what would cause initialization, because my entry point was static.
In fact, the answer was easy: it came through the closures.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Well, that&amp;#8217;s what I thought, because even after eliminating closures, I still got the damn error.
In fact, it turns out the situation is far more complex.
For example, I had this innocent looking code:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint groovy language-groovy&quot;&gt;&lt;code&gt;def baseDir = args[0]
server.createContext(&quot;/&quot;, new HttpHandler() {
    @Override
    void handle(HttpExchange exchange) throws IOException {
        ...
        someCodeUses(baseDir)
    })&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The fact that we use &lt;code&gt;baseDir&lt;/code&gt; &lt;em&gt;within&lt;/em&gt; an anonymous inner class, and that Groovy uses the same code generation under the hood for both closures and anonymous inner classes, that the &lt;code&gt;baseDir&lt;/code&gt; variable is allowed to be mutated in the inner class. Of course here I&amp;#8217;m not doing it, but because the compiler doesn&amp;#8217;t eliminate that possibility, what it does is generating a &lt;code&gt;groovy.lang.Reference&lt;/code&gt; for my local variable, that is used in the inner class.
And, initializing the &lt;code&gt;Reference&lt;/code&gt; class would cause an additional path to this &lt;code&gt;IndyInterface&lt;/code&gt; method call&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the end, the problem is not that much that there&amp;#8217;s a &lt;code&gt;MethodHandle&lt;/code&gt;, it&amp;#8217;s that there are potentially different code paths that lead to this, and that GraalVM can&amp;#8217;t figure out in the end a single method to be called: we&amp;#8217;re just defeating the system!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;For example, even creating an anonymous inner class would still trigger the creation of a metaclass for it: this means that even if we replace the closure with an inner class, in the end, we would still trigger the initialization of the Groovy runtime.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;I tried to be smart and remove the &lt;code&gt;IndyInterface&lt;/code&gt; from the code that GraalVM is using to generate the native image, knowing that in the end, this code would &lt;em&gt;never&lt;/em&gt; be called if I didn&amp;#8217;t register the Java 7 plugin (that I wouldn&amp;#8217;t use in any case). However, it turns out that GraalVM doesn&amp;#8217;t like this, as it has special handling for Groovy, and that if you &lt;em&gt;remove&lt;/em&gt; that class, it fails with:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;Error: substitution target for com.oracle.svm.polyglot.groovy.Target_org_codehaus_groovy_vmplugin_v7_IndyInterface_invalidateSwitchPoints is not loaded. Use field `onlyWith` in the `TargetClass` annotation to make substitution only active when needed.&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;So instead I spent hours eliminating those paths, which involved:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;turning that shared variable into a field in order to workaround the reference initialization&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;removing all closures&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;removing usages of &lt;code&gt;GString&lt;/code&gt; (interpolated strings, which is why you see &lt;code&gt;String.format&lt;/code&gt; instead)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;replacing the short-hand syntax for creating lists (&lt;code&gt;def foo=[]&lt;/code&gt;) with an explicit call&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;removing calls to &lt;code&gt;+&lt;/code&gt; with strings (first attempt to remove GString&amp;#8230;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;eliminating some classes from the Groovy runtime&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;replacing some classes of the Groovy runtime with stubs, preventing static initialization&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In the end, I have &lt;a href=&quot;https://github.com/melix/graal-simple-httpserver/blob/master/http-groovy/build.gradle.kts&quot;&gt;something which works&lt;/a&gt;, but you can see that the build file is far more complex.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In particular, it makes use of a little known Gradle feature called &lt;em&gt;artifact transforms&lt;/em&gt;. Basically, I&amp;#8217;m asking Gradle to transform the Groovy jar &lt;em&gt;before&lt;/em&gt; GraalVM uses it. This transformation involves filtering out classes, so that GraalVM doesn&amp;#8217;t try to be too smart about them.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Once this is done, we can finally generate a native image for Groovy too:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;./gradlew http-groovy:nativeImage&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;It takes about &lt;a href=&quot;https://scans.gradle.com/s/p4ctmi5pzune4&quot;&gt;the same amount of time as with Kotlin&lt;/a&gt; to generate a similar 11MB native image.
Running it is as easy:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;http-groovy/build/graal/httpserv-groovy 9090 /path/to/files&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;And again it&amp;#8217;s super snappy!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_conclusion&quot;&gt;Conclusion&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;At this stage, you might consider that it&amp;#8217;s a success: we got both Kotlin and Groovy code compiled into a native image that is very snappy and starts even faster than the Python server.
However, getting the Groovy version to work was &lt;em&gt;hours of pain&lt;/em&gt;. Each time I managed to fix a problem, another one arose.
Basically, every method call, every extension method you call is likely to trigger initialization of some Groovy subsystem, or trigger additional paths to this &lt;code&gt;IndyInterface&lt;/code&gt; code.
In the end it would be nice if GraalVM could completely eliminate the need for having this class, but until then I just cannot recommend anyone to use Groovy to build native images: it&amp;#8217;s just &lt;em&gt;too frustrating&lt;/em&gt;.
And remember that even if you manage to make it work, it takes both a significant amount of time to do so, but also forces you to write non idiomatic code.
Last but not least, &lt;em&gt;any&lt;/em&gt; addition to your code is likely to force you to update your GraalVM configuration to make it work.
In the end, it&amp;#8217;s just way easier to write plain old Java code, or go Kotlin.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Note that I&amp;#8217;m not saying that it&amp;#8217;s not possible with Groovy, but &lt;a href=&quot;https://e.printstacktrace.blog/graalvm-and-groovy-how-to-start/&quot;&gt;folks usually face different problems than I did&lt;/a&gt;, in particular when it&amp;#8217;s just about configuring classes accessed by reflection: this is a simple problem.
I&amp;#8217;m not saying either that you should avoid Groovy: I just think it&amp;#8217;s not suited for this use case. I still use Groovy everyday, in particular in tests or for simple scripts (in replacement to bash scripts). However, more worrisome is that if an application transitively depends on Groovy, it&amp;#8217;s unlikely to be &quot;GraalVM compatible&quot;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Eventually, if you look at the Kotlin version and the companion Gradle build, it&amp;#8217;s extremely simple, thanks to the great work done by the Palantir team!&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;admonitionblock note&quot;&gt;
&lt;table&gt;
&lt;tr&gt;
&lt;td class=&quot;icon&quot;&gt;
&lt;div class=&quot;title&quot;&gt;Note&lt;/div&gt;
&lt;/td&gt;
&lt;td class=&quot;content&quot;&gt;
After this blog post was published, I received a &lt;a href=&quot;https://github.com/melix/graal-simple-httpserver/pull/1&quot;&gt;pull request from Szymon Stepniak&lt;/a&gt; improving the Groovy code a lot. The resulting file is, however, twice as big (23MB!). It does &lt;em&gt;not&lt;/em&gt; change my vision on this either, because it took 2 men to reach this point, in a significant amount of time.
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Gradle myth busting: lifecycle</title>
      <link>https://melix.github.io/blog/2018/09/gradle-lifecycle.html</link>
      <pubDate>Tue, 11 Sep 2018 00:00:00 +0200</pubDate>
      <guid isPermaLink="false">2018/09/gradle-lifecycle.html</guid>
      	<description>
	&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_the_build_lifecycle&quot;&gt;The build lifecycle&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;There&amp;#8217;s a very common misconception I read from Maven users about Gradle: that there&amp;#8217;s no default lifecycle. Not only this is &lt;a href=&quot;https://scans.gradle.com/s/alokg5xymahwa/timeline?task=345te4gku5gw4&quot; target=&quot;_blank&quot;&gt;wrong&lt;/a&gt;, but actually the Gradle lifecycle is significanly richer.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;First, let&amp;#8217;s explain in a few words what the lifecycle is in Maven. Detailed explanations can be found &lt;a href=&quot;https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html&quot; target=&quot;&lt;em&gt;blank&quot;&gt;here&lt;/a&gt;, but in a nutshell, the idea is that _any&lt;/em&gt; build will always consist in a sequence of phases, and that each phase is built on top of the previous one. This has the advantage of being simple to explain: to deploy an application, you first need compile it, run the tests, package it, perform validation (checkstyle, &amp;#8230;) and deploy. Let me ignore &lt;em&gt;install&lt;/em&gt; which is an artifact of how Maven works.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Maven plugins attach themselves to those lifecycle phases, and define goals on different phases. For example, a code generator would attach itself to the &lt;code&gt;generate-sources&lt;/code&gt; phase, and define a &lt;em&gt;goal&lt;/em&gt; that runs at this phase. Fun begins when you have dependencies between the goals, and ordering matters&amp;#8230; Anyway, the general idea is that if you want to get the outcome of, say, packaging, you have to execute all previous phases and consequently all goals that are defined on those phases. The other consequence is that the Maven lifecycle is biased towards the Java model, and more specifically, building Java libraries. It&amp;#8217;s even clearer when you think about the term &lt;code&gt;deploy&lt;/code&gt;, which doesn&amp;#8217;t mean &quot;deploy this application on production&quot;, but &quot;push this jar on the external Maven repository&quot;. Similarly &quot;install&quot; doesn&amp;#8217;t mean &quot;install this application on my laptop&quot;, but &quot;copy this library into my local .m2 repository&quot;. This, I would argue, is rather counter-intuitive&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Gradle, on the other hand, is a generic build tool. It&amp;#8217;s aimed at the Java ecosystem, but also the native one, the Android ecosystem, Python, Go, &amp;#8230; It doesn&amp;#8217;t matter. All of those ecosystems have an underlying model, and the way you build applications or libraries in each of those ecosystems is different. Gradle offers the APIs to &lt;em&gt;model the builds&lt;/em&gt; of each ecosystem. This flexibility is often what troubles Maven users, and makes them think there&amp;#8217;s no lifecycle, but it&amp;#8217;s not true.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_goals_vs_tasks&quot;&gt;Goals vs tasks&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;To understand why, we need to explain that Gradle model is not &lt;em&gt;phase&lt;/em&gt; based, but &lt;em&gt;task&lt;/em&gt; based. It&amp;#8217;s a bit like what Ant did, but the similarity stops there. While Ant didn&amp;#8217;t define &lt;em&gt;any&lt;/em&gt; convention, &lt;em&gt;any&lt;/em&gt; lifecycle, and everything was different from one build to the other, this is not true with Gradle. By default, if you apply this &quot;Java library&quot; plugin, you&amp;#8217;ll get &lt;em&gt;all the conventions you find with Maven&lt;/em&gt;:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;listingblock&quot;&gt;
&lt;div class=&quot;content&quot;&gt;
&lt;pre class=&quot;prettyprint&quot;&gt;&lt;code&gt;plugins {
   id &apos;java-library&apos;
}&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is the minimal build file you need to build, test and package a Java library with Gradle, with the same conventions as Maven &lt;code&gt;src/main/java&lt;/code&gt;, &amp;#8230; By applying this plugin, Gradle internally applies a sequence of plugins, which, in turn, would define new tasks, and more specifically for the topic of this blog post, &lt;em&gt;lifecycle tasks&lt;/em&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;In Gradle, a task is responsible for executing a unit of work. For example, &quot;compile this source set&quot;. A task has inputs (the source files) and outputs (the class files). But a task also has &lt;em&gt;dependencies&lt;/em&gt;. In particular, dependencies on other tasks. Gradle makes sure that a task graph is a DAG (direct, acyclic graph). This means that if you run &lt;code&gt;compile&lt;/code&gt; on the command-line, what Gradle does is:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;compute the task dependencies of &lt;code&gt;compile&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;execute the tasks &lt;em&gt;in order&lt;/em&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Task dependencies can be explicit (say, &lt;code&gt;compile.dependsOn(compileJava)&lt;/code&gt;), or implicit (because you add a source set as an input, &lt;strong&gt;and&lt;/strong&gt; that this source set is generated by another task, then we know we need to run the code generation &lt;em&gt;for this source set&lt;/em&gt; before). This model is nice because it&amp;#8217;s significantly more fine grained than the phase one. When you execute a task, Gradle will always perform the minimal amount of work required to get the output of this task. Let&amp;#8217;s illustrate with an example: say you want to run the unit tests of your library. You would run the &lt;code&gt;test&lt;/code&gt; task with Gradle. Gradle would then determine that:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;it needs to compile the sources of the library (&lt;code&gt;compileJava&lt;/code&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;but the sources includes a generated source set, so it needs to execute it (&lt;code&gt;generateSources&lt;/code&gt;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;it would also find that the &quot;resources&quot; are an input of the test classpath, so execute the &lt;code&gt;processResources&lt;/code&gt; task&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;etc&amp;#8230;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;But, in the end, it would &lt;em&gt;not&lt;/em&gt; generate the jar file. Because Gradle knows that to run the tests, there&amp;#8217;s no need to get the jar: we can build a classpath that consists of the generated classes and the resources directories. It&amp;#8217;s actually very easy to figure out what the task dependencies are by running with &lt;code&gt;--dry-run&lt;/code&gt;, or using a &lt;a href=&quot;https://scans.gradle.com/s/mfihmuxqj2b2u/dependencies?focusedDependency=WzE3LDEsNTgsWzE3LDEsWzIzNiw1OF1dXQ&amp;amp;toggled=W1s4XSxbMTddLFsxNywxXSxbMTcsMSxbMjM2XV1d&quot; target=&quot;_blank&quot;&gt;build scan&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_so_will_you_tell_me_what_the_lifecycle_of_gradle_is_then&quot;&gt;So, will you tell me what the lifecycle of Gradle is then?&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;This is the trick. With Gradle, everything boils down to tasks, which are a bit like functions, with inputs and outputs. But there are special kinds of tasks, that we call &quot;lifecycle tasks&quot;, which are &lt;em&gt;binding other tasks together&lt;/em&gt;. They, effectively, produce no output individually. Their only role is to have dependencies on other tasks, so that we have nice shortcuts to produce our outputs. For example, the &lt;code&gt;check&lt;/code&gt; task is a lifecycle task which has dependencies on the &lt;code&gt;test&lt;/code&gt; task, but also the &lt;code&gt;checkstyle&lt;/code&gt; task, etc&amp;#8230; Plugins are free to add dependencies to the &lt;code&gt;check&lt;/code&gt; task, and &lt;em&gt;enrich&lt;/em&gt; the check lifecycle this way. But even better, by defining dependencies between tasks like that, and clearly defining the inputs and outputs of each task, we make it possible to get &lt;em&gt;correct&lt;/em&gt; incremental builds, as well as &lt;em&gt;caching&lt;/em&gt; (and no, this &lt;a href=&quot;https://docs.gradle.org/current/userguide/build_cache.html&quot; target=&quot;_blank&quot;&gt;has nothing to do with &lt;code&gt;~/.m2&lt;/code&gt;&lt;/a&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;The good news is that because lifecycle tasks are just regular tasks, it means they can also depend on each other, and you can build your own lifecycle tasks. It becomes very easy to model your build production pipeline. So here is a simple correspondance matrix for Maven users, for the Java library plugin:&lt;/p&gt;
&lt;/div&gt;
&lt;table class=&quot;tableblock frame-all grid-all&quot; style=&quot;width:100%; &quot;&gt;
&lt;caption class=&quot;title&quot;&gt;Table 1. Lifecycle correspondance matrix&lt;/caption&gt;
&lt;colgroup&gt;
&lt;col style=&quot;width:33%;&quot;&gt;
&lt;col style=&quot;width:33%;&quot;&gt;
&lt;col style=&quot;width:33%;&quot;&gt; 
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th class=&quot;tableblock halign-left valign-top&quot;&gt;Maven&lt;/th&gt;
&lt;th class=&quot;tableblock halign-left valign-top&quot;&gt;Gradle&lt;/th&gt;
&lt;th class=&quot;tableblock halign-left valign-top&quot;&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;clean&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;clean&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;Removes the outputs of tasks&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;compile&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;classes&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;Generates the classes from source files&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;test&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;test&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;Executes unit tests&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;package&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;assemble&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;Creates a jar&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;verify&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;check&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;Runs all tests, integration tests, quality checks, &amp;#8230;&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;install&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;publishToMavenLocal&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;Gradle doesn&amp;#8217;t need a local repository, but should you need Maven interoperability, you can add the &lt;code&gt;maven-publish&lt;/code&gt; plugin to add this task&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;deploy&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;publishToMavenRepository&lt;/p&gt;&lt;/td&gt;
&lt;td class=&quot;tableblock halign-left valign-top&quot;&gt;&lt;p class=&quot;tableblock&quot;&gt;This tasks is &lt;em&gt;not&lt;/em&gt; available by default, as it depends on which type of repository you deploy to. In general you just apply the &lt;code&gt;maven-publish&lt;/code&gt; plugin to add this task&lt;/p&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;But remember: in Gradle, tasks depend on each other. So it means that if you run a lifecycle task, &lt;em&gt;only the tasks required for that specific target are going to be executed&lt;/em&gt;. Nothing more.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;sect1&quot;&gt;
&lt;h2 id=&quot;_see_us_at_devoxx_belgium&quot;&gt;See us at Devoxx Belgium!&lt;/h2&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;If you want to discover more of the differences between Gradle and Maven, come see my colleague Louis Jacomet and I during Devoxx Belgium, we&amp;#8217;re giving a &lt;a href=&quot;https://dvbe18.confinabox.com/talk/UAH-5130/Switching_to_Gradle:_maturity,_performance,_and_pleasure!&quot; target=&quot;_blank&quot;&gt;deep dive into Gradle&lt;/a&gt; where we&amp;#8217;re going to cover what is explained here, and much more!&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Assistants vocaux et robotisation: mon point de vue</title>
      <link>https://melix.github.io/blog/2018/07/robots-vs-human.html</link>
      <pubDate>Tue, 3 Jul 2018 00:00:00 +0200</pubDate>
      <guid isPermaLink="false">2018/07/robots-vs-human.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt;
&lt;div class=&quot;sectionbody&quot;&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Ce billet essaie de rÃ©sumer une conversation que j&amp;#8217;ai eu avec mon frÃ¨re, concernant les craintes autour des assistants vocaux, et, plus gÃ©nÃ©ralement, la robotisation. Je partage une grande partie de &lt;a href=&quot;https://www.blogdumoderateur.com/role-controverse-assistants-vocaux/&quot;&gt;son point de vue&lt;/a&gt;, mais j&amp;#8217;ai aussi de larges diffÃ©rences que je voulais rÃ©sumer ici. C&amp;#8217;est parti !&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;h1 id=&quot;__ok_google_cr_e_un_malaise&quot; class=&quot;sect0&quot;&gt;&quot;Ok Google, crÃ©e un malaise&quot;&lt;/h1&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Le week-end dernier, Ã  l&amp;#8217;occasion d&amp;#8217;un barbecue en famille Ã  la maison, ma moitiÃ© a, au dÃ©tour d&amp;#8217;une conversation, lancÃ© cette phrase par pur rÃ©flexe:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;&quot;Ok Google, &amp;lt;question anodine&amp;gt;&quot;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;LÃ , mon frÃ¨re, Guillaume, a fait un malaise. Etendu sur le sol, pris de spasmes incontrÃ´lables, en position foetale, il baffouillait des phrases pour la plupart inintelligibles, mais, par moments, j&amp;#8217;arrivais Ã  comprendre des bribes comme &quot;pas eux&quot;, &quot;GDPR&quot;, ou autres &quot;Saint Qwant venez-vous en aide&quot;. AprÃ¨s quelques minutes, l&amp;#8217;intervention d&amp;#8217;un seau d&amp;#8217;eau et rongÃ© par la honte de se montrer ainsi devant junior, Guillaume repris ses esprits, et commenÃ§a une discussion trop courte parce qu&amp;#8217;interrompue par la nÃ©cessitÃ© autrement plus primaire de faire griller quelques saucisses.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Au final, la question se rÃ©sume Ã  celle-ci: pourquoi ? De mon cÃ´tÃ©, je suis assez ouvert sur l&amp;#8217;utilisation des assistants, et je dois dire que c&amp;#8217;est quelque chose que j&amp;#8217;attendais vÃ©ritablement depuis des annÃ©es. De lonnngggues annÃ©es. Guillaume n&amp;#8217;avait probablement rien notÃ© jusqu&amp;#8217;ici parce que mon assistant prenait la forme d&amp;#8217;une enceinte bluetooth classique, alors qu&amp;#8217;il s&amp;#8217;agit en fait une enceinte Sony intÃ©grant la technologie de Google. J&amp;#8217;avais choisi ce modÃ¨le principalement parce qu&amp;#8217;une des utilisations que je fais de cet assistant, probablement la plus frÃ©quente, est de lui demander de me diffuser de la musique (via Deezer), ou la radio. La domotique, c&amp;#8217;est un peu un rÃªve de gosse pour moi, j&amp;#8217;adore tout piloter, par une appli, ou par la voix. Donc parmi les autres utilisations que j&amp;#8217;en fais, il y a:&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;ulist&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;contrÃ´ler mes lumiÃ¨res, mon thermostat&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;contrÃ´ler ma box domotique (et donc les appareils non directement &quot;connectÃ©s&quot;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;demander des informations (mÃ©tÃ©o, Ã  quelle heure est le match de la France, &amp;#8230;)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;enclencher un minuteur pour la cuisine, ajouter des rappels&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Le problÃ¨me, qui choque Guillaume, est que pour avoir accÃ¨s Ã  toutes ces fonctions, je partage Ã©normÃ©ment de donnÃ©es avec El Diablo (Google). Oui, mais j&amp;#8217;en suis conscient. Et, par ailleurs, mon compte est configurÃ© avec une extrÃªme prÃ©caution. Notamment, j&amp;#8217;ai complÃ¨tement dÃ©sactivÃ© la personnalisation des annonces. Je garde nÃ©anmoins certaines fonctionnalitÃ©s comme le traÃ§age de ma position gÃ©ographique (qui, par une occasion, m&amp;#8217;a permis de dÃ©montrer Ã  des amis qu&amp;#8217;on Ã©tait bien allÃ© les voir au mois d&amp;#8217;Octobre :)). J&amp;#8217;ai plus de mal, en revanche, sur l&amp;#8217;historique des recherches. Mais le noeud du problÃ¨me, c&amp;#8217;est qui dÃ©tient les donnÃ©es, ce qu&amp;#8217;ils en font et en particulier avec qui ils les partagent. Pour ma part, la seule raison pour laquelle j&amp;#8217;utilise les services de Google est qu&amp;#8217;ils me permettent &lt;em&gt;techniquement&lt;/em&gt; de faire ce que je veux. Si, demain, j&amp;#8217;ai la possibilitÃ© d&amp;#8217;avoir une box locale qui m&amp;#8217;offre les mÃªmes capacitÃ©s, y compris lorsqu&amp;#8217;invoquÃ©e via IFTTT, je signe Ã  quatre mains. En attendant que celÃ  existe, et j&amp;#8217;espÃ¨re sincÃ¨rement que celÃ  arrivera au plus vite, je fais des compromis, et il faut Ãªtre conscient de ce que l&amp;#8217;on a a la maison.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;LÃ  oÃ¹ je suis moins d&amp;#8217;accord, c&amp;#8217;est la diabolisation Ã  l&amp;#8217;extrÃªme des assistants. Je reviendrais plus tard sur quelques raisons, mais en particulier un argument que j&amp;#8217;entends souvent, c&amp;#8217;est &quot;oui mais lÃ  tu as un micro qui Ã©coute tout le temps chez toi et qui envoie tes donnÃ©es Ã  Google&quot;. Ah, nous y voilÃ . Quel est le problÃ¨me ?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;olist arabic&quot;&gt;
&lt;ol class=&quot;arabic&quot;&gt;
&lt;li&gt;
&lt;p&gt;Ã§a Ã©coute tout le temps ?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Ã§a envoie tes donnÃ©es ?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Ã§a les envoie Ã  Google ?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;qui traite des infos ?&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;h1 id=&quot;_intention_malicieuse_ou_non&quot; class=&quot;sect0&quot;&gt;Intention malicieuse ou non ?&lt;/h1&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;J&amp;#8217;avoue que j&amp;#8217;ai du mal Ã  comprendre les rÃ©ticences ici. Probablement parce que je suis un dÃ©veloppeur naif, mais les bugs, les amis, je suis dÃ©solÃ© de vous l&amp;#8217;apprendre, il y en aura toujours. Donc, oui, il arrivera que votre Google Home, votre Amazon Alexa ou autre, se mette Ã  enregistrer une conversation qu&amp;#8217;il n&amp;#8217;aurait pas du, et l&amp;#8217;envoie sur les serveurs de Google. En rÃ¨gle gÃ©nÃ©rale, on le comprend assez vite, parce que la douce voix robotique vous rÃ©pondra quelque chose du genre &quot;dÃ©solÃ©, je ne sais pas comment vous aider&quot;. Que s&amp;#8217;est-il vraiment passÃ© ? La box a cru entendre un mot clÃ©. Souvent, on se demande parfois pourquoi Google n&amp;#8217;offre pas la possibilitÃ© de changer ce mot clÃ© (&quot;Ok Google&quot;, &quot;hey Google&quot;, &amp;#8230;). Je pense qu&amp;#8217;une des raisons est ce que l&amp;#8217;interprÃ©tation de ce mot clÃ© est forcÃ©ment locale. La puissance nÃ©cessaire pour reconnaitre parfaitement l&amp;#8217;expression, et son contexte de dÃ©clenchement avec le bruit, est restreinte. Donc, parfois, pas de bol, Ã§a croit entendre &quot;Ok Google&quot;, ou, pire, Ã§a s&amp;#8217;enclenche lorsque la pub passe Ã  la tÃ©lÃ©. En rÃ¨gle gÃ©nÃ©rale, Ã§a fait plutÃ´t rire mes enfants, rien de dramatique. D&amp;#8217;autant qu&amp;#8217;on sait que Ã§a s&amp;#8217;enclenche grÃ¢ce au signal sonore &quot;attention, Google Ã©coute&quot;. Donc, un bug, c&amp;#8217;est un bug. Ca n&amp;#8217;est pas parce que Ã§a &lt;em&gt;peut&lt;/em&gt; envoyer des donnÃ©es sans votre accord que l&amp;#8217;intention derriÃ¨re est malicieuse. Dois-je vous rappeler les histoires d&amp;#8217;activation Ã  distance des webcams des Mac Book par la NSA ? On n&amp;#8217;est pas dans la mÃªme catÃ©gorie, lÃ . Enfin, des micros qui Ã©coutent tout le temps, vous en avez en poche depuis des annÃ©es: vos tÃ©lÃ©phones mobiles. Ils font exactement la mÃªme chose, sont activables Ã  distance, et probablement infectÃ©s de tonnes de malwares, parfois installÃ©es en usine, Ã  des fins d&amp;#8217;espionnage gouvernemental. Si je dois me mÃ©fier de quelque chose, personnelement, c&amp;#8217;est plus de Ã§a que de Google recevant ma discussion sur tata Simone.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Par ailleurs, une fois la conversation envoyÃ©e sur le &quot;cloud&quot; (Ã§a fait peur, le cloud, on ne sait pas ce qui s&amp;#8217;y passe), elle est analysÃ©e. Pensez-vous que ce sont des humains qui analysent votre question et renvoie la rÃ©ponse en 2s ? Non, la puissance de calcul nÃ©cessaire pour interprÃ©ter correctement votre question et titanesque. Elle nÃ©cessite des techniques avancÃ©es (TALN, statistiques, oui, vous savez, la mÃªme chose que ce gros mot &quot;big data&quot;), et l&amp;#8217;apprentissage pour l&amp;#8217;amÃ©lioration de la qualitÃ© des rÃ©ponses requiert le stockage de quantitÃ©s monstrueuses d&amp;#8217;information. Je ne suis pas convaincu que Google doive pour autant &lt;em&gt;stocker&lt;/em&gt; toutes les conversations, mais je conÃ§ois parfaitement qu&amp;#8217;en analysant les requÃªtes de millions d&amp;#8217;utilisateurs, avec des voix diffÃ©rentes, des accents diffÃ©rents et des contextes culturels diffÃ©rents, on est capable de faire beaucoup mieux qu&amp;#8217;en ne stockant rien et analysant localement. Le temps oÃ¹ il fallait patiemment passer des heures Ã  rÃ©pÃ©ter des tonnes de phrases Ã  son logiciel de reconnaissance vocal n&amp;#8217;est pas si loin&amp;#8230;&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Donc, oui, Google va recevoir ma voix. Oui, il va l&amp;#8217;analyser et construire un profil, qu&amp;#8217;il pourra partager. Je suis au courant. Et j&amp;#8217;ai, dans la mesure du possible, restreint ces possibilitÃ©s. Je serai d&amp;#8217;autant plus heureux le jour oÃ¹ je n&amp;#8217;aurai pas besoin de lui confier mes donnÃ©es. Mais l&amp;#8217;intÃ©gration, la simpliciter d&amp;#8217;utilisation, et le seul fait que Ã§a marche, aujourd&amp;#8217;hui, est la raison de son adoption. Enfin, on dit que Ã§a marche, mais aprÃ¨s des mois d&amp;#8217;utilisation, il ne faut pas trÃ¨s longtemps pour comprendre que malgrÃ© les quantitÃ©s Ã©normes de donnÃ©es dont Google dispose, dans de trÃ¨s nombreux cas, l&amp;#8217;assistant est complÃ¨tement Ã  la ramasse. Genre, on lui demande si un match passe sur TF1, il est incapable de rÃ©pondre. On lui demande &quot;quel temps va-t-il faire&quot;, il comprend &quot;tempÃ©rature&quot;. On apprend mÃªme Ã  reformuler nos questions pour que l&amp;#8217;assistant les comprenne. Bizarre, et frustrant. Mais, Ã§a montre les limite de la technologie, et casse quelques mythes. En particulier, il faut se mÃ©fier des annonces autour de Google Duplex, l&amp;#8217;assistant qui prend des rendez-vous Ã  votre place: oui, Ã§a marche, c&amp;#8217;est bluffant, mais il est conÃ§u pour cette tÃ¢che spÃ©cifique, et il est finalement assez simple, d&amp;#8217;aprÃ¨s les premiers retours, de lui faire perdre le fil.&lt;/p&gt;
&lt;/div&gt;
&lt;h1 id=&quot;_la_relation_homme_machine&quot; class=&quot;sect0&quot;&gt;La relation homme-machine&lt;/h1&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;NÃ©anmoins, la conversation a dÃ©viÃ© vers l&amp;#8217;intelligence artificielle en rÃ¨gle gÃ©nÃ©rale, et la relation qu&amp;#8217;on a avec les machines. Sur ce sujet, je suis &lt;em&gt;extrÃªmement&lt;/em&gt; ouvert. Je suis trÃ¨s introverti, et, personnellement, avoir une conversation avec une machine a un cÃ´tÃ© rassurant. Me demandez pas pourquoi, c&amp;#8217;est un fait. Je narrais aussi cette anecdote Ã  mon frÃ¨re: un de mes enfants a des difficultÃ©s Ã  parler aux adultes. Il marmonne, ne les regarde pas dans les yeux, et met &lt;em&gt;beaucoup&lt;/em&gt; de temps Ã  leur accorder sa confiance (mais une fois qu&amp;#8217;elle est acquise, il n&amp;#8217;y a plus de pb). Personnellement, Ã§a ne m&amp;#8217;a jamais inquiÃ©tÃ©, j&apos;Ã©tais pareil enfant, et Ã§a n&amp;#8217;a (je pense) pas fait de moi un Ãªtre associal (j&amp;#8217;espÃ¨re). Disposant de Google Home, mon fils s&amp;#8217;est naturellement mis Ã  l&amp;#8217;utiliser lui aussi. Et ses premiÃ¨res expÃ©riences Ã©taient frustrantes: n&amp;#8217;articulant pas, la machine n&apos;Ã©tait pas capable de le comprendre. En quelques semaines seulement, il a progressÃ© plus qu&amp;#8217;en plusieurs annÃ©es: dÃ©sormais, il articule et parle fort, y compris aux adultes (Ã  de rares exceptions prÃ¨s pour ceux qui l&amp;#8217;impressionnent comme le mÃ©decin). Ce sujet en a apportÃ© un autre: celui du fait de faire dire aux enfants &quot;merci&quot; ou &quot;s&amp;#8217;il te plait&quot; aux machines.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Guillaume est, si j&amp;#8217;ai bien compris, contre l&amp;#8217;humanisation des machines. Pour ma part, j&amp;#8217;y suis favorable, et je suis donc pour la &quot;politesse envers les machines&quot;. Fondamentalement, je pense qu&amp;#8217;une partie des craintes de Guillaume se fondent sur le fait de confier l&amp;#8217;empathie aux machines et que des algorithmes s&amp;#8217;en servent pour nous manipuler. L&amp;#8217;autre aspect est l&amp;#8217;aliÃ©nation de l&amp;#8217;homme Ã  la machine, c&amp;#8217;est Ã  dire apprendre Ã  des enfants Ã  obÃ©ir non plus Ã  des hommes mais Ã  des machines. Soit, c&amp;#8217;est une crainte lÃ©gitime. Je suis plus cynique que celÃ : je doute qu&amp;#8217;une machine puisse faire pire qu&amp;#8217;un Ãªtre humain. En fait, j&amp;#8217;ai plus d&amp;#8217;espoir envers les machines que je n&amp;#8217;en ai envers les Ãªtres humains. L&amp;#8217;histoire a montrÃ© a de trop nombreuses occasions que l&amp;#8217;empathie n&amp;#8217;est pas l&amp;#8217;apparat de tout le monde, bien au contraire. L&amp;#8217;utilisation des biais cognitifs Ã  des fins de manipulation (vente, politique, abus de confiance), Ã§a n&amp;#8217;a rien de nouveau. Est-ce qu&amp;#8217;il faut craindre que les algorithmes fassent de mÃªme ? Oui. Serait-ce pire qu&amp;#8217;avec des humains ? J&amp;#8217;en doute, bien au contraire. L&amp;#8217;imagination perverse des hommes n&amp;#8217;est plus Ã  dÃ©montrer. Leur intolÃ©rance non plus.&lt;/p&gt;
&lt;/div&gt;
&lt;h1 id=&quot;_suis_je_humain&quot; class=&quot;sect0&quot;&gt;Suis-je humain ?&lt;/h1&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;J&amp;#8217;ai grandi avec Star Trek.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Cette sÃ©rie est probablement celle qui a influencÃ© une grande partie de ma pensÃ©e. DÃ©ja dans Star Trek TOS, l&amp;#8217;ordinateur et la domotique Ã©taient au coeur de la relation homme-machine. La machine Ã©tait naturellement intÃ©grÃ©e, un personnage &quot;vivant&quot; en quelque sorte. Puis, arriva Star Trek The Next Generation, avec des personnages encore plus humanistes, mais un personnage en particulier, Data, change la donne: un Androide dont la seule quÃªte Ã©tait de devenir humain. Un membre Ã  part entiÃ¨re de l&apos;Ã©quipage. Un &lt;a href=&quot;https://en.wikipedia.org/wiki/The_Measure_of_a_Man_%28Star_Trek:_The_Next_Generation%29&quot;&gt;Ã©pisode en particulier traite spÃ©cifiquement du sujet du droit des robots&lt;/a&gt;: Data devait-il Ãªtre considÃ©rÃ© comme une machine ou un humain ? Un scientifique a-t-il le droit de le dÃ©membrer pour l&apos;Ã©tudier sur le seul prÃ©texte qu&amp;#8217;il s&amp;#8217;agit d&amp;#8217;une machine ?&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;J&amp;#8217;adore cette sÃ©rie pour celÃ : son humanisme, sa capacitÃ© Ã  rechercher ce qu&amp;#8217;il y a de meilleur chez l&amp;#8217;homme, et son ouverture en gÃ©nÃ©ral. Subtilement mais sÃ»rement, les sujets sensibles sur le racisme, le transhumanisme, l&amp;#8217;homosexualitÃ© y sont traitÃ©s.&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;paragraph&quot;&gt;
&lt;p&gt;Je fais donc partie de ceux qui prÃ©fÃ¨rent avoir une &quot;conversation&quot; avec une machine polie, lui rÃ©pondre &quot;merci&quot;, tout en sachant qu&amp;#8217;il ne s&amp;#8217;agit que d&amp;#8217;une machine, plutÃ´t de de causer Ã  un con&amp;#8230; raciste, homophobe, ou plus frÃ©quemment un tÃ©lÃ©commercial essayant toutes les techniques possibles pour me vendre ses panneaux solaires sachant pertinnement que je veux terminer ma conversation avec lui. Je pense que la politesse, le &quot;savoir vivre&quot;, procure une certaine satisfaction, une relaxation, qui est un concept totallement orthogonal avec le sujet (l&amp;#8217;homme ou la machine). Il n&amp;#8217;est pas surprenant pour moi que des autistes s&amp;#8217;ouvrent plus facilement avec la prÃ©sence d&amp;#8217;un animal (chien, chat, peu importe), ou que certaines expÃ©riences montrent des enfants &lt;a href=&quot;https://www.topsante.com/medecine/psycho/autisme/des-robots-une-aide-pour-les-enfants-autistes-63967&quot;&gt;faisant des progrÃ¨s en parlant Ã  des robots&lt;/a&gt;. L&amp;#8217;interaction, la socialisation est importante. Et si le robot est meilleur que l&amp;#8217;homme sur ce sujet, on doit s&amp;#8217;en rÃ©jouir ! L&amp;#8217;homme a toujours cherchÃ© Ã  crÃ©er des choses Ã  son image (Ã§a ne vous rapelle rien ?) et il se trouve que notre cerveau est conÃ§u pour reconnaitre la douleur de l&amp;#8217;autre (empathie) et y rÃ©agir. Je prÃ©fÃ¨re donc 100 fois, que dis-je, 1000 fois un homme poli envers un robot, qu&amp;#8217;un homme traitant une autre personne comme une machine. C&amp;#8217;est peut-Ãªtre naif, mais j&amp;#8217;ai espoir qu&amp;#8217;en apprenant Ã  des enfants Ã  Ãªtre polis envers des machines, ils apprendront d&amp;#8217;autant plus Ã  l&apos;Ãªtre envers les autres, et qu&amp;#8217;on effacera une partie de ce mal, qui est la disparition Ã  l&apos;Ã©chelle de la sociÃ©tÃ© de l&amp;#8217;empathie. Et mon rÃªve de gosse, c&amp;#8217;est de voir un Data Ã©merger. Montrer qu&amp;#8217;avec suffisamment de puissance, une machine puisse prendre son autonomie. On en est encore loin, mais, on rÃ©duit dÃ©ja ce qui est &quot;visible&quot; entre homme et machine. Si je ne suis pas capable de faire la diffÃ©rence entre un homme et une machine dans une conversation, qu&amp;#8217;est-ce que celÃ  dit de moi ? Qu&amp;#8217;est-ce que celÃ  dit de la machine ? Et si, nous mÃªmes, n&apos;Ã©tions finalement qu&amp;#8217;une machine un peu sophistiquÃ©e, issue de l&apos;Ã©volution. Une machine douÃ©e de pensÃ©e et de sentiments, mais une machine quand mÃªme.&lt;/p&gt;
&lt;/div&gt;
	</description>
    </item>

  </channel> 
</rss>
